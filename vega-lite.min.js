!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.vl=e()}}(function(){var e;return function n(e,t,i){function a(o,u){if(!t[o]){if(!e[o]){var c="function"==typeof require&&require;if(!u&&c)return c(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var s=t[o]={exports:{}};e[o][0].call(s.exports,function(n){var t=e[o][1][n];return a(t?t:n)},s,s.exports,n,e,t,i)}return t[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(n,t,i){!function(n,a){"object"==typeof i&&"undefined"!=typeof t?a(i):"function"==typeof e&&e.amd?e("d3-time",["exports"],a):a(n.d3_time={})}(this,function(e){"use strict";function n(e,t,i,o){function u(n){return e(n=new Date(+n)),n}return u.floor=u,u.round=function(n){var i=new Date(+n),a=new Date(n-1);return e(i),e(a),t(a,1),a-n>n-i?i:a},u.ceil=function(n){return e(n=new Date(n-1)),t(n,1),n},u.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},u.range=function(n,i,a){var r=[];if(n=new Date(n-1),i=new Date(+i),a=null==a?1:Math.floor(a),!(i>n&&a>0))return r;for(t(n,1),e(n),i>n&&r.push(new Date(+n));t(n,a),e(n),i>n;)r.push(new Date(+n));return r},u.filter=function(i){return n(function(n){for(;e(n),!i(n);)n.setTime(n-1)},function(e,n){for(;--n>=0;)for(;t(e,1),!i(e););})},i&&(u.count=function(n,t){return a.setTime(+n),r.setTime(+t),e(a),e(r),Math.floor(i(a,r))},u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u.filter(o?function(n){return o(n)%e===0}:function(n){return u.count(0,n)%e===0}):u:null}),u}function t(e){return n(function(n){n.setHours(0,0,0,0),n.setDate(n.getDate()-(n.getDay()+7-e)%7)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5})}function i(e){return n(function(n){n.setUTCHours(0,0,0,0),n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/6048e5})}var a=new Date,r=new Date,o=n(function(){},function(e,n){e.setTime(+e+n)},function(e,n){return n-e});o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?n(function(n){n.setTime(Math.floor(n/e)*e)},function(n,t){n.setTime(+n+t*e)},function(n,t){return(t-n)/e}):o:null};var u=n(function(e){e.setMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getSeconds()}),c=n(function(e){e.setSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getMinutes()}),l=n(function(e){e.setMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getHours()}),s=n(function(e){e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/864e5},function(e){return e.getDate()-1}),f=t(0),d=t(1),p=t(2),m=t(3),h=t(4),g=t(5),v=t(6),y=n(function(e){e.setHours(0,0,0,0),e.setDate(1)},function(e,n){e.setMonth(e.getMonth()+n)},function(e,n){return n.getMonth()-e.getMonth()+12*(n.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),O=n(function(e){e.setHours(0,0,0,0),e.setMonth(0,1)},function(e,n){e.setFullYear(e.getFullYear()+n)},function(e,n){return n.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}),T=n(function(e){e.setUTCMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getUTCSeconds()}),x=n(function(e){e.setUTCSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getUTCMinutes()}),E=n(function(e){e.setUTCMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getUTCHours()}),C=n(function(e){e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n)},function(e,n){return(n-e)/864e5},function(e){return e.getUTCDate()-1}),A=i(0),b=i(1),L=i(2),M=i(3),k=i(4),N=i(5),R=i(6),S=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(1)},function(e,n){e.setUTCMonth(e.getUTCMonth()+n)},function(e,n){return n.getUTCMonth()-e.getUTCMonth()+12*(n.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),D=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCMonth(0,1)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n)},function(e,n){return n.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}),U=o.range,I=u.range,_=c.range,Y=l.range,w=s.range,X=f.range,P=d.range,W=p.range,F=m.range,H=h.range,z=g.range,Z=v.range,B=f.range,j=y.range,q=O.range,V=o,G=U,Q=T.range,K=x.range,$=E.range,J=C.range,ee=A.range,ne=b.range,te=L.range,ie=M.range,ae=k.range,re=N.range,oe=R.range,ue=A.range,ce=S.range,le=D.range,se="0.1.1";e.version=se,e.milliseconds=U,e.seconds=I,e.minutes=_,e.hours=Y,e.days=w,e.sundays=X,e.mondays=P,e.tuesdays=W,e.wednesdays=F,e.thursdays=H,e.fridays=z,e.saturdays=Z,e.weeks=B,e.months=j,e.years=q,e.utcMillisecond=V,e.utcMilliseconds=G,e.utcSeconds=Q,e.utcMinutes=K,e.utcHours=$,e.utcDays=J,e.utcSundays=ee,e.utcMondays=ne,e.utcTuesdays=te,e.utcWednesdays=ie,e.utcThursdays=ae,e.utcFridays=re,e.utcSaturdays=oe,e.utcWeeks=ue,e.utcMonths=ce,e.utcYears=le,e.millisecond=o,e.second=u,e.minute=c,e.hour=l,e.day=s,e.sunday=f,e.monday=d,e.tuesday=p,e.wednesday=m,e.thursday=h,e.friday=g,e.saturday=v,e.week=f,e.month=y,e.year=O,e.utcSecond=T,e.utcMinute=x,e.utcHour=E,e.utcDay=C,e.utcSunday=A,e.utcMonday=b,e.utcTuesday=L,e.utcWednesday=M,e.utcThursday=k,e.utcFriday=N,e.utcSaturday=R,e.utcWeek=A,e.utcMonth=S,e.utcYear=D,e.interval=n})},{}],2:[function(e,n,t){function i(e){if(!e)throw Error("Missing binning options.");var n,t,i,u,c,l,s,f=e.maxbins||15,d=e.base||10,p=Math.log(d),m=e.div||[5,2],h=e.min,g=e.max,v=g-h;if(e.step)n=e.step;else if(e.steps)n=e.steps[Math.min(e.steps.length-1,a(e.steps,v/f,0,e.steps.length))];else{for(t=Math.ceil(Math.log(f)/p),i=e.minstep||0,n=Math.max(i,Math.pow(d,Math.round(Math.log(v)/p)-t));Math.ceil(v/n)>f;)n*=d;for(l=0;l<m.length;++l)c=n/m[l],c>=i&&f>=v/c&&(n=c)}return c=Math.log(n),u=c>=0?0:~~(-c/p)+1,s=Math.pow(d,-u-1),h=Math.min(h,Math.floor(h/n+s)*n),g=Math.ceil(g/n)*n,{start:h,stop:g,step:n,unit:{precision:u},value:r,index:o}}function a(e,n,t,i){for(;i>t;){var a=t+i>>>1;l.cmp(e[a],n)<0?t=a+1:i=a}return t}function r(e){return this.step*Math.floor(e/this.step+f)}function o(e){return Math.floor((e-this.start)/this.step+f)}function u(e){return this.unit.date(r.call(this,e))}function c(e){return o.call(this,this.unit.unit(e))}var l=e("../util"),s=e("../time"),f=1e-15;i.date=function(e){if(!e)throw Error("Missing date binning options.");var n=e.utc?s.utc:s,t=e.min,a=e.max,r=e.maxbins||20,o=e.minbins||4,l=+a-+t,f=e.unit?n[e.unit]:n.find(l,o,r),d=i({min:null!=f.min?f.min:f.unit(t),max:null!=f.max?f.max:f.unit(a),maxbins:r,minstep:f.minstep,steps:f.step});return d.unit=f,d.index=c,e.raw||(d.value=u),d},n.exports=i},{"../time":4,"../util":5}],3:[function(e,n,t){var i=e("./util"),a=n.exports;a.repeat=function(e,n){var t,i=Array(n);for(t=0;n>t;++t)i[t]=e;return i},a.zeros=function(e){return a.repeat(0,e)},a.range=function(e,n,t){if(arguments.length<3&&(t=1,arguments.length<2&&(n=e,e=0)),(n-e)/t==1/0)throw new Error("Infinite range");var i,a=[],r=-1;if(0>t)for(;(i=e+t*++r)>n;)a.push(i);else for(;(i=e+t*++r)<n;)a.push(i);return a},a.random={},a.random.uniform=function(e,n){void 0===n&&(n=void 0===e?1:e,e=0);var t=n-e,i=function(){return e+t*Math.random()};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(i){return i>=e&&n>=i?1/t:0},i.cdf=function(i){return e>i?0:i>n?1:(i-e)/t},i.icdf=function(n){return n>=0&&1>=n?e+n*t:NaN},i},a.random.integer=function(e,n){void 0===n&&(n=e,e=0);var t=n-e,i=function(){return e+Math.floor(t*Math.random())};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(i){return i===Math.floor(i)&&i>=e&&n>i?1/t:0},i.cdf=function(i){var a=Math.floor(i);return e>a?0:a>=n?1:(a-e+1)/t},i.icdf=function(n){return n>=0&&1>=n?e-1+Math.floor(n*t):NaN},i},a.random.normal=function(e,n){e=e||0,n=n||1;var t,i=function(){var i,a,r=0,o=0;if(void 0!==t)return r=t,t=void 0,r;do r=2*Math.random()-1,o=2*Math.random()-1,i=r*r+o*o;while(0===i||i>1);return a=Math.sqrt(-2*Math.log(i)/i),t=e+o*a*n,e+r*a*n};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(t){var i=Math.exp(Math.pow(t-e,2)/(-2*Math.pow(n,2)));return 1/(n*Math.sqrt(2*Math.PI))*i},i.cdf=function(t){var i,a=(t-e)/n,r=Math.abs(a);if(r>37)i=0;else{var o,u=Math.exp(-r*r/2);7.07106781186547>r?(o=.0352624965998911*r+.700383064443688,o=o*r+6.37396220353165,o=o*r+33.912866078383,o=o*r+112.079291497871,o=o*r+221.213596169931,o=o*r+220.206867912376,i=u*o,o=.0883883476483184*r+1.75566716318264,o=o*r+16.064177579207,o=o*r+86.7807322029461,o=o*r+296.564248779674,o=o*r+637.333633378831,o=o*r+793.826512519948,o=o*r+440.413735824752,i/=o):(o=r+.65,o=r+4/o,o=r+3/o,o=r+2/o,o=r+1/o,i=u/o/2.506628274631)}return a>0?1-i:i},i.icdf=function(t){if(0>=t||t>=1)return NaN;var i=2*t-1,a=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),r=2/(Math.PI*a)+Math.log(1-Math.pow(i,2))/2,o=Math.log(1-i*i)/a,u=(i>0?1:-1)*Math.sqrt(Math.sqrt(r*r-o)-r);return e+n*Math.SQRT2*u},i},a.random.bootstrap=function(e,n){var t=e.filter(i.isValid),r=t.length,o=n?a.random.normal(0,n):null,u=function(){return t[~~(Math.random()*r)]+(o?o():0)};return u.samples=function(e){return a.zeros(e).map(u)},u}},{"./util":5}],4:[function(e,n,t){function i(e){return l.setTime(+e),l}function a(e,n,t,i,a,r){var o={type:e,date:n,unit:t};return i?o.step=i:o.minstep=1,null!=a&&(o.min=a),null!=r&&(o.max=r),o}function r(e,n,t,i,r,o){return a(e,function(e){return n.offset(t,e)},function(e){return n.count(t,e)},i,r,o)}function o(e,n,t,i){var a,r,o,u=m[0];for(a=1,r=m.length;r>a;++a)if(u=m[a],n>u[0]){if(o=n/u[0],o>i)return e[m[a-1][1]];if(o>=t)return e[u[1]]}return e[m[r-1][1]]}function u(e){var n,t,i={};for(n=0,t=e.length;t>n;++n)i[e[n].type]=e[n];return i.find=function(n,t,i){return o(e,n,t,i)},i}var c=e("d3-time"),l=new Date,s=new Date(0,0,1).setFullYear(0),f=new Date(Date.UTC(0,0,1)).setUTCFullYear(0),d=[r("second",c.second,s),r("minute",c.minute,s),r("hour",c.hour,s),r("day",c.day,s,[1,7]),r("month",c.month,s,[1,3,6]),r("year",c.year,s),a("seconds",function(e){return new Date(1970,0,1,0,0,e)},function(e){return i(e).getSeconds()},null,0,59),a("minutes",function(e){return new Date(1970,0,1,0,e)},function(e){return i(e).getMinutes()},null,0,59),a("hours",function(e){return new Date(1970,0,1,e)},function(e){return i(e).getHours()},null,0,23),a("weekdays",function(e){return new Date(1970,0,4+e)},function(e){return i(e).getDay()},[1],0,6),a("dates",function(e){return new Date(1970,0,e)},function(e){return i(e).getDate()},[1],1,31),a("months",function(e){return new Date(1970,e%12,1)},function(e){return i(e).getMonth()},[1],0,11)],p=[r("second",c.utcSecond,f),r("minute",c.utcMinute,f),r("hour",c.utcHour,f),r("day",c.utcDay,f,[1,7]),r("month",c.utcMonth,f,[1,3,6]),r("year",c.utcYear,f),a("seconds",function(e){return new Date(Date.UTC(1970,0,1,0,0,e))},function(e){return i(e).getUTCSeconds()},null,0,59),a("minutes",function(e){return new Date(Date.UTC(1970,0,1,0,e))},function(e){return i(e).getUTCMinutes()},null,0,59),a("hours",function(e){return new Date(Date.UTC(1970,0,1,e))},function(e){return i(e).getUTCHours()},null,0,23),a("weekdays",function(e){return new Date(Date.UTC(1970,0,4+e))},function(e){return i(e).getUTCDay()},[1],0,6),a("dates",function(e){return new Date(Date.UTC(1970,0,e))},function(e){return i(e).getUTCDate()},[1],1,31),a("months",function(e){return new Date(Date.UTC(1970,e%12,1))},function(e){return i(e).getUTCMonth()},[1],0,11)],m=[[31536e6,5],[7776e6,4],[2592e6,4],[12096e5,3],[6048e5,3],[1728e5,3],[864e5,3],[432e5,2],[216e5,2],[108e5,2],[36e5,2],[18e5,1],[9e5,1],[3e5,1],[6e4,1],[3e4,0],[15e3,0],[5e3,0],[1e3,0]];n.exports=u(d),n.exports.utc=u(p)},{"d3-time":1}],5:[function(e,n,t){(function(e){function t(e){return e.replace(c,"$1\\'")}function i(e,n){var t,i="";for(t=0;e>t;++t)i+=n;return i}function a(e,n,t){var i=0,a=e.split(s);return e=t?(a=a.reverse()).filter(function(e){return i+=e.length,n>=i}).reverse():a.filter(function(e){return i+=e.length,n>=i}),e.length?e.join("").trim():a[0].slice(0,n)}var r=n.exports,o="__name__";r.namedfunc=function(e,n){return n[o]=e,n},r.name=function(e){return null==e?null:e[o]},r.identity=function(e){return e},r["true"]=r.namedfunc("true",function(){return!0}),r["false"]=r.namedfunc("false",function(){return!1}),r.duplicate=function(e){return JSON.parse(JSON.stringify(e))},r.equal=function(e,n){return JSON.stringify(e)===JSON.stringify(n)},r.extend=function(e){for(var n,t,i=1,a=arguments.length;a>i;++i){n=arguments[i];for(t in n)e[t]=n[t]}return e},r.length=function(e){return null!=e&&null!=e.length?e.length:null},r.keys=function(e){var n,t=[];for(n in e)t.push(n);return t},r.vals=function(e){var n,t=[];for(n in e)t.push(e[n]);return t},r.toMap=function(e,n){return(n=r.$(n))?e.reduce(function(e,t){return e[n(t)]=1,e},{}):e.reduce(function(e,n){return e[n]=1,e},{})},r.keystr=function(e){var n=e.length;if(!n)return"";for(var t=String(e[0]),i=1;n>i;++i)t+="|"+String(e[i]);return t};var u=Object.prototype.toString;r.isObject=function(e){return e===Object(e)},r.isFunction=function(e){return"[object Function]"===u.call(e)},r.isString=function(e){return"string"==typeof value||"[object String]"===u.call(e)},r.isArray=Array.isArray||function(e){return"[object Array]"===u.call(e)},r.isNumber=function(e){return"number"==typeof e||"[object Number]"===u.call(e)},r.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},r.isDate=function(e){return"[object Date]"===u.call(e)},r.isValid=function(e){return null!=e&&e===e},r.isBuffer="function"==typeof e&&e.isBuffer||r["false"],r.number=function(e){return null==e||""===e?null:+e},r["boolean"]=function(e){return null==e||""===e?null:"false"===e?!1:!!e},r.date=function(e,n){var t=n?n:Date;return null==e||""===e?null:t.parse(e)},r.array=function(e){return null!=e?r.isArray(e)?e:[e]:[]},r.str=function(e){return r.isArray(e)?"["+e.map(r.str)+"]":r.isObject(e)?JSON.stringify(e):r.isString(e)?"'"+t(e)+"'":e};var c=/(^|[^\\])'/g,l=/\[(.*?)\]|[^.\[]+/g;r.field=function(e){return String(e).match(l).map(function(e){return"["!==e[0]?e:"'"!==e[1]&&'"'!==e[1]?e.slice(1,-1):e.slice(2,-2).replace(/\\(["'])/g,"$1")})},r.accessor=function(e){var n;return null==e||r.isFunction(e)?e:r.namedfunc(e,(n=r.field(e)).length>1?function(e){return n.reduce(function(e,n){return e[n]},e)}:function(n){return n[e]})},r.$=r.accessor,r.mutator=function(e){var n;return r.isString(e)&&(n=r.field(e)).length>1?function(e,t){for(var i=0;i<n.length-1;++i)e=e[n[i]];e[n[i]]=t}:function(n,t){n[e]=t}},r.$func=function(e,n){return function(t){t=r.$(t)||r.identity;var i=e+(r.name(t)?"_"+r.name(t):"");return r.namedfunc(i,function(e){return n(t(e))})}},r.$valid=r.$func("valid",r.isValid),r.$length=r.$func("length",r.length),r.$in=function(e,n){e=r.$(e);var t=r.isArray(n)?r.toMap(n):n;return function(n){return!!t[e(n)]}},r.comparator=function(e){var n=[];return void 0===e&&(e=[]),e=r.array(e).map(function(e){var t=1;return"-"===e[0]?(t=-1,e=e.slice(1)):"+"===e[0]&&(t=1,e=e.slice(1)),n.push(t),r.accessor(e)}),function(t,i){var a,r,o,u,c;for(a=0,r=e.length;r>a;++a){if(o=e[a],u=o(t),c=o(i),c>u)return-1*n[a];if(u>c)return n[a]}return 0}},r.cmp=function(e,n){return n>e?-1:e>n?1:e>=n?0:null===e?-1:null===n?1:NaN},r.numcmp=function(e,n){return e-n},r.stablesort=function(e,n,t){var i=e.reduce(function(e,n,i){return e[t(n)]=i,e},{});return e.sort(function(e,a){var r=n(e),o=n(a);return o>r?-1:r>o?1:i[t(e)]-i[t(a)]}),e},r.pad=function(e,n,t,a){a=a||" ";var r=n-e.length;if(0>=r)return e;switch(t){case"left":return i(r,a)+e;case"middle":case"center":return i(Math.floor(r/2),a)+e+i(Math.ceil(r/2),a);default:return e+i(r,a)}},r.truncate=function(e,n,t,i,r){var o=e.length;if(n>=o)return e;r=void 0!==r?String(r):"…";var u=Math.max(0,n-r.length);switch(t){case"left":return r+(i?a(e,u,1):e.slice(o-u));case"middle":case"center":var c=Math.ceil(u/2),l=Math.floor(u/2);return(i?a(e,c):e.slice(0,c))+r+(i?a(e,l,1):e.slice(o-l));default:return(i?a(e,u):e.slice(0,u))+r}};var s=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/}).call(this,e("buffer").Buffer)},{buffer:6}],6:[function(e,n,t){},{}],7:[function(e,n,t){t.AGGREGATE_OPS=["values","count","valid","missing","distinct","sum","mean","average","variance","variancep","stdev","stdevp","median","q1","q3","modeskew","min","max","argmin","argmax"],t.SHARED_DOMAIN_OPS=["mean","average","stdev","stdevp","median","q1","q3","min","max"]},{}],8:[function(e,n,t){function i(e){switch(e){case a.ROW:case a.COLUMN:case a.SIZE:case a.SHAPE:return 6;default:return 10}}var a=e("./channel");t.autoMaxBins=i},{"./channel":9}],9:[function(e,n,t){function i(e,n){return!!a(e)[n]}function a(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.DETAIL:case t.ORDER:case t.ROW:case t.COLUMN:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0,text:!0};case t.SIZE:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,text:!0};case t.SHAPE:return{point:!0};case t.TEXT:return{text:!0};case t.PATH:return{line:!0}}return{}}function r(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.LABEL:return{measure:!0,dimension:!0};case t.ROW:case t.COLUMN:case t.SHAPE:case t.DETAIL:return{measure:!1,dimension:!0};case t.SIZE:case t.TEXT:return{measure:!0,dimension:!1};case t.PATH:return{measure:!1,dimension:!0}}throw new Error("Invalid encoding channel"+e)}function o(e){return!u.contains([t.DETAIL,t.PATH,t.TEXT,t.LABEL,t.ORDER],e)}var u=e("./util");!function(e){e[e.X="x"]="X",e[e.Y="y"]="Y",e[e.ROW="row"]="ROW",e[e.COLUMN="column"]="COLUMN",e[e.SHAPE="shape"]="SHAPE",e[e.SIZE="size"]="SIZE",e[e.COLOR="color"]="COLOR",e[e.TEXT="text"]="TEXT",e[e.DETAIL="detail"]="DETAIL",e[e.LABEL="label"]="LABEL",e[e.PATH="path"]="PATH",e[e.ORDER="order"]="ORDER"}(t.Channel||(t.Channel={}));var c=t.Channel;t.X=c.X,t.Y=c.Y,t.ROW=c.ROW,t.COLUMN=c.COLUMN,t.SHAPE=c.SHAPE,t.SIZE=c.SIZE,t.COLOR=c.COLOR,t.TEXT=c.TEXT,t.DETAIL=c.DETAIL,t.LABEL=c.LABEL,t.PATH=c.PATH,t.ORDER=c.ORDER,t.CHANNELS=[t.X,t.Y,t.ROW,t.COLUMN,t.SIZE,t.SHAPE,t.COLOR,t.PATH,t.ORDER,t.TEXT,t.DETAIL,t.LABEL],t.supportMark=i,t.getSupportedMark=a,t.getSupportedRole=r,t.hasScale=o},{"./util":45}],10:[function(e,n,t){var i=e("../schema/config.schema"),a=e("../channel"),r=e("../data"),o=e("../fielddef"),u=e("../encoding"),c=e("../mark"),l=e("../type"),s=e("../util"),f=e("./config"),d=e("./stack"),p=e("./scale"),m=function(){function e(e){var n=this;this._spec=e;var t=this._spec.mark,r=this._spec.encoding=this._spec.encoding||{},o=this._config=s.mergeDeep(s.duplicate(i.defaultConfig),e.config);u.forEach(this._spec.encoding,function(e,n){a.supportMark(n,this._spec.mark)||(console.warn(n,"dropped as it is incompatible with",this._spec.mark),delete this._spec.encoding[n].field),e.type&&(e.type=l.getFullName(e.type)),n!==a.PATH&&n!==a.ORDER||e.aggregate||e.type!==l.QUANTITATIVE||(e.aggregate="min")},this);var m=this._scale=[a.X,a.Y,a.COLOR,a.SHAPE,a.SIZE,a.ROW,a.COLUMN].reduce(function(e,i){if(u.has(r,i)){var l=r[i].scale||{},f=r[i],d=p.type(l,f,i,t);s.contains([a.ROW,a.COLUMN],i)?e[i]=s.extend({type:d,round:o.facet.scale.round,padding:i===a.ROW&&n.has(a.Y)||i===a.COLUMN&&n.has(a.X)?o.facet.scale.padding:0},l):e[i]=s.extend({type:d,round:o.scale.round,padding:o.scale.padding,useRawDomain:o.scale.useRawDomain,bandWidth:i===a.X&&"ordinal"===d&&t===c.TEXT?o.scale.textBandWidth:o.scale.bandWidth},l)}return e},{});this._axis=[a.X,a.Y,a.ROW,a.COLUMN].reduce(function(e,n){if(u.has(r,n)){var t=r[n].axis;t!==!1&&(e[n]=s.extend({},n===a.X||n===a.Y?o.axis:o.facet.axis,t===!0?{}:t||{}))}return e},{}),this._legend=[a.COLOR,a.SHAPE,a.SIZE].reduce(function(e,n){if(u.has(r,n)){var t=r[n].legend;t!==!1&&(e[n]=s.extend({},o.legend,t===!0?{}:t||{}))}return e},{}),this._stack=d.compileStackProperties(t,r,m,o),this._config.mark=f.compileMarkConfig(t,r,o,this._stack)}return e.prototype.stack=function(){return this._stack},e.prototype.toSpec=function(e,n){var t,i=s.duplicate(this._spec.encoding);return t={mark:this._spec.mark,encoding:i},e||(t.config=s.duplicate(this._spec.config)),n||(t.data=s.duplicate(this._spec.data)),t},e.prototype.mark=function(){return this._spec.mark},e.prototype.spec=function(){return this._spec},e.prototype.is=function(e){return this._spec.mark===e},e.prototype.has=function(e){return u.has(this._spec.encoding,e)},e.prototype.encoding=function(){return this._spec.encoding},e.prototype.fieldDef=function(e){return this._spec.encoding[e]||{}},e.prototype.field=function(e,n){void 0===n&&(n={});var t=this.fieldDef(e),i=this.scale(e);return t.bin&&(n=s.extend({binSuffix:"ordinal"===p.type(i,t,e,this.mark())?"_range":"_start"},n)),o.field(t,n)},e.prototype.fieldTitle=function(e){return o.title(this._spec.encoding[e])},e.prototype.channels=function(){return u.channels(this._spec.encoding)},e.prototype.map=function(e,n){return u.map(this._spec.encoding,e,n)},e.prototype.reduce=function(e,n,t){return u.reduce(this._spec.encoding,e,n,t)},e.prototype.forEach=function(e,n){u.forEach(this._spec.encoding,e,n)},e.prototype.isOrdinalScale=function(e){var n=this.fieldDef(e),t=this.scale(e);return this.has(e)&&"ordinal"===p.type(t,n,e,this.mark())},e.prototype.isDimension=function(e){return o.isDimension(this.fieldDef(e))},e.prototype.isMeasure=function(e){return o.isMeasure(this.fieldDef(e))},e.prototype.isAggregate=function(){return u.isAggregate(this._spec.encoding)},e.prototype.isFacet=function(){return this.has(a.ROW)||this.has(a.COLUMN)},e.prototype.dataTable=function(){return this.isAggregate()?r.SUMMARY:r.SOURCE},e.prototype.data=function(){return this._spec.data},e.prototype.transform=function(){return this._spec.transform||{}},e.prototype.config=function(){return this._config},e.prototype.sort=function(e){return this._spec.encoding[e].sort},e.prototype.scale=function(e){return this._scale[e]},e.prototype.axis=function(e){return this._axis[e]},e.prototype.legend=function(e){return this._legend[e]},e.prototype.scaleName=function(e){var n=this.spec().name;return(n?n+"-":"")+e},e.prototype.sizeValue=function(e){void 0===e&&(e=a.SIZE);var n=this.fieldDef(a.SIZE);if(n&&void 0!==n.value)return n.value;switch(this.mark()){case c.TEXT:return this.config().mark.fontSize;case c.BAR:return this.config().mark.barWidth?this.config().mark.barWidth:this.isOrdinalScale(e)?this.scale(e).bandWidth-1:this.has(e)?2:21;case c.TICK:if(this.config().mark.tickWidth)return this.config().mark.tickWidth;var t=this.has(e)?this.scale(e).bandWidth:21;return t/1.5}return this.config().mark.size},e}();t.Model=m},{"../channel":9,"../data":29,"../encoding":30,"../fielddef":31,"../mark":32,"../schema/config.schema":36,"../type":44,"../util":45,"./config":13,"./scale":25,"./stack":26}],11:[function(e,n,t){function i(e,n){var i=e===h.COLUMN,a=e===h.ROW,r=i?"x":a?"y":e,o={type:r,scale:n.scaleName(e),grid:!0,tickSize:0,properties:{labels:{text:{value:""}},axis:{stroke:{value:"transparent"}}}},u=n.axis(e);return["layer","ticks","values","subdivide"].forEach(function(i){var a,r=(a=t[i])?a(n,e,o):u[i];void 0!==r&&(o[i]=r)}),o}function a(e,n){var i=e===h.COLUMN,a=e===h.ROW,r=i?"x":a?"y":e,o=n.axis(e),u={type:r,scale:n.scaleName(e)};p.extend(u,g.formatMixins(n,e,n.axis(e).format)),["grid","layer","offset","orient","tickSize","ticks","title","tickPadding","tickSize","tickSizeMajor","tickSizeMinor","tickSizeEnd","titleOffset","values","subdivide"].forEach(function(i){var a,r=(a=t[i])?a(n,e,u):o[i];void 0!==r&&(u[i]=r)});var c=n.axis(e).properties||{};return["axis","labels","grid","title","ticks","majorTicks","minorTicks"].forEach(function(t){var i=v[t]?v[t](n,e,c[t],u):c[t];void 0!==i&&(u.properties=u.properties||{},u.properties[t]=i)}),u}function r(e,n){return e.axis(n).offset}function o(e,n){var t=e.axis(n).grid;return void 0!==t?t:!e.isOrdinalScale(n)&&!e.fieldDef(n).bin}function u(e,n){return n!==h.ROW&&n!==h.COLUMN?o(e,n)&&(n===h.Y||n===h.X)&&!(e.has(h.COLUMN)||e.has(h.ROW)):void 0}function c(e,n,t){var i=e.axis(n).layer;return void 0!==i?i:t.grid?"back":void 0}function l(e,n){var t=e.axis(n).orient;return t?t:n===h.COLUMN?"top":n===h.ROW&&e.has(h.Y)&&"right"!==e.axis(h.Y).orient?"right":void 0}function s(e,n){var t=e.axis(n).ticks;return void 0!==t?t:n!==h.X||e.fieldDef(n).bin?void 0:5}function f(e,n){var t=e.axis(n).tickSize;return void 0!==t?t:void 0}function d(e,n){var t=e.axis(n);if(void 0!==t.title)return t.title;var i,a=e.fieldTitle(n);return t.titleMaxLength?i=t.titleMaxLength:n!==h.X||e.isOrdinalScale(h.X)?n!==h.Y||e.isOrdinalScale(h.Y)||(i=e.config().unit.height/e.axis(h.Y).characterWidth):i=e.config().unit.width/e.axis(h.X).characterWidth,i?p.truncate(a,i):a}var p=e("../util"),m=e("../type"),h=e("../channel"),g=e("./util");t.compileInnerAxis=i,t.compileAxis=a,t.offset=r,t.gridShow=o,t.grid=u,t.layer=c,t.orient=l,t.ticks=s,t.tickSize=f,t.title=d;var v;!function(e){function n(e,n,t,i){var a=e.axis(n);return p.extend(void 0!==a.axisWidth?{strokeWidth:{value:a.axisWidth}}:{},t||{})}function t(e,n,t,i){var a=e.fieldDef(n),r=e.axis(n);if(!r.labels)return p.extend({text:""},t);switch(p.contains([m.NOMINAL,m.ORDINAL],a.type)&&r.labelMaxLength&&(t=p.extend({text:{template:"{{ datum.data | truncate:"+r.labelMaxLength+"}}"}},t||{})),r.labelAngle&&(t=p.extend({angle:{value:r.labelAngle}},t||{})),n){case h.X:(e.isDimension(h.X)||a.type===m.TEMPORAL)&&(t=p.extend({angle:{value:270},align:{value:"top"===i.orient?"left":"right"},baseline:{value:"middle"}},t||{}));break;case h.ROW:"right"===i.orient&&(t=p.extend({angle:{value:90},align:{value:"center"},baseline:{value:"bottom"}},t||{}))}return t||void 0}e.axis=n,e.labels=t}(v=t.properties||(t.properties={}))},{"../channel":9,"../type":44,"../util":45,"./util":28}],12:[function(e,n,t){function i(e){var n=new r.Model(e),t=n.config(),i=m.extend(e.name?{name:e.name}:{},{width:1,height:1,padding:"auto"},t.viewport?{viewport:t.viewport}:{},t.background?{background:t.background}:{},{data:u.compileData(n).concat([c.compileLayoutData(n)]),marks:[a(n)]});return{spec:i}}function a(e){var n=e.spec(),t=m.extend({name:n.name?n.name+"-root":"root",type:"group"},n.description?{description:n.description}:{},{from:{data:h.LAYOUT},properties:{update:{width:{field:"width"},height:{field:"height"}}}}),i=f.compileMark(e);if(e.has(g.ROW)||e.has(g.COLUMN))m.extend(t,l.facetMixins(e,i));else{p.applyConfig(t.properties.update,e.config().unit,p.FILL_STROKE_CONFIG.concat(["clip"])),t.marks=i,t.scales=d.compileScales(e.channels(),e);var a=(e.has(g.X)&&e.axis(g.X)?[o.compileAxis(g.X,e)]:[]).concat(e.has(g.Y)&&e.axis(g.Y)?[o.compileAxis(g.Y,e)]:[]);a.length>0&&(t.axes=a)}var r=s.compileLegends(e);return r.length>0&&(t.legends=r),t}var r=e("./Model"),o=e("./axis"),u=e("./data"),c=e("./layout"),l=e("./facet"),s=e("./legend"),f=e("./mark"),d=e("./scale"),p=e("./util"),m=e("../util"),h=e("../data"),g=e("../channel"),v=e("./Model");t.Model=v.Model,t.compile=i,t.compileRootGroup=a},{"../channel":9,"../data":29,"../util":45,"./Model":10,"./axis":11,"./data":14,"./facet":15,"./layout":16,"./legend":17,"./mark":24,"./scale":25,"./util":28}],13:[function(e,n,t){function i(e,n,t,i){return c.extend(["filled","opacity","orient","align"].reduce(function(l,s){var f=t.mark[s];switch(s){case"filled":void 0===f&&(l[s]=e!==u.POINT&&e!==u.LINE);break;case"opacity":void 0===f&&c.contains([u.POINT,u.TICK,u.CIRCLE,u.SQUARE],e)&&(!r.isAggregate(n)||r.has(n,a.DETAIL))&&(l[s]=.7);break;case"orient":i&&(l[s]=i.groupbyChannel===a.Y?"horizontal":void 0),void 0===f&&(l[s]=o.isMeasure(n[a.X])&&!o.isMeasure(n[a.Y])?"horizontal":void 0);break;case"align":void 0===f&&(l[s]=r.has(n,a.X)?"center":"right")}return l},{}),t.mark)}var a=e("../channel"),r=e("../encoding"),o=e("../fielddef"),u=e("../mark"),c=e("../util");t.compileMarkConfig=i},{"../channel":9,"../encoding":30,"../fielddef":31,"../mark":32,"../util":45}],14:[function(e,n,t){function i(e){var n=[g.def(e)],t=v.def(e);t&&n.push(t),a(n[n.length-1],e),r(n[n.length-1],e);var i=e.stack();return i&&n.push(y.def(e,i)),n.concat(O.defs(e))}function a(e,n){n.has(l.COLOR)&&n.fieldDef(l.COLOR).type===d.ORDINAL&&(e.transform=e.transform.concat([{type:"sort",by:n.field(l.COLOR)},{type:"rank",field:n.field(l.COLOR),output:{rank:n.field(l.COLOR,{prefn:"rank_"})}}]))}function r(e,n){n.forEach(function(t,i){var a=n.scale(i);a&&"log"===a.type&&e.transform.push({type:"filter",test:n.field(i,{datum:!0})+" > 0"})})}var o=e("../fielddef"),u=e("../util"),c=e("../bin"),l=e("../channel"),s=e("../data"),f=e("../fielddef"),d=e("../type"),p=e("./scale"),m=e("./time"),h={nominal:!1,ordinal:!1,quantitative:!0,temporal:!0};t.compileData=i;var g;!function(e){function n(e){var n={name:s.SOURCE},a=e.data();if(a)if(a.values&&a.values.length>0)n.values=e.data().values,n.format={type:"json"};else if(a.url){n.url=a.url;var r=/(?:\.([^.]+))?$/.exec(n.url)[1];u.contains(["json","csv","tsv"],r)||(r="json"),n.format={type:e.data().formatType||r}}var o=t(e);return o&&(n.format=n.format||{},n.format.parse=o),n.transform=i(e),n}function t(e){var n,t=(e.transform().calculate||[]).reduce(function(e,n){return e[n.field]=!0,e},{});return e.forEach(function(e){if(e.type===d.TEMPORAL)n=n||{},n[e.field]="date";else if(e.type===d.QUANTITATIVE){if(o.isCount(e)||t[e.field])return;n=n||{},n[e.field]="number"}}),n}function i(e){return g(e).concat(y(e),v(e),r(e),a(e))}function a(e){return e.reduce(function(e,n,t){var i=f.field(n,{nofn:!0,datum:!0});return n.type===d.TEMPORAL&&n.timeUnit&&e.push({type:"formula",field:f.field(n),expr:m.parseExpression(n.timeUnit,i)}),e},[])}function r(e){return e.reduce(function(n,t,i){var a=e.fieldDef(i).bin,r=e.scale(i);if(a){var o=u.extend({type:"bin",field:t.field,output:{start:f.field(t,{binSuffix:"_start"}),mid:f.field(t,{binSuffix:"_mid"}),end:f.field(t,{binSuffix:"_end"})}},"boolean"==typeof a?{}:a);o.maxbins||o.step||(o.maxbins=c.autoMaxBins(i)),n.push(o),("ordinal"===p.type(r,t,i,e.mark())||i===l.COLOR)&&n.push({type:"formula",field:f.field(t,{binSuffix:"_range"}),expr:f.field(t,{datum:!0,binSuffix:"_start"})+" + '-' + "+f.field(t,{datum:!0,binSuffix:"_end"})})}return n},[])}function g(e){var n=e.transform().filterNull,t=u.keys(e.reduce(function(e,t){return(n||void 0===n&&t.field&&"*"!==t.field&&h[t.type])&&(e[t.field]=!0),e},{}));return t.length>0?[{type:"filter",test:t.map(function(e){return"datum."+e+"!==null"}).join(" && ")}]:[]}function v(e){var n=e.transform().filter;return n?[{type:"filter",test:n}]:[]}function y(e){return(e.transform().calculate||[]).reduce(function(e,n){return e.push(u.extend({type:"formula"},n)),e},[])}e.def=n,e.transform=i,e.timeTransform=a,e.binTransform=r,e.nullFilterTransform=g,e.filterTransform=v,e.formulaTransform=y}(g=t.source||(t.source={}));var v;!function(e){function n(e){var n={},t={},i=!1;e.forEach(function(a,r){if(a.aggregate)i=!0,"count"===a.aggregate?(t["*"]=t["*"]||{},t["*"].count=!0):(t[a.field]=t[a.field]||{},t[a.field][a.aggregate]=!0);else if(a.bin){n[f.field(a,{binSuffix:"_start"})]=f.field(a,{binSuffix:"_start"}),n[f.field(a,{binSuffix:"_mid"})]=f.field(a,{binSuffix:"_mid"}),n[f.field(a,{binSuffix:"_end"})]=f.field(a,{binSuffix:"_end"});var o=e.scale(r);"ordinal"===p.type(o,a,r,e.mark())&&(n[f.field(a,{binSuffix:"_range"})]=f.field(a,{binSuffix:"_range"}))}else n[f.field(a)]=f.field(a)});var a=u.vals(n),r=u.reduce(t,function(e,n,t){return e[t]=u.keys(n),e},{});return i?{name:s.SUMMARY,source:s.SOURCE,transform:[{type:"aggregate",groupby:a,summarize:r}]}:null}e.def=n}(v=t.summary||(t.summary={}));var y;!function(e){function n(e,n){var t=n.groupbyChannel,i=n.fieldChannel,a=(e.has(l.COLUMN)?[e.field(l.COLUMN)]:[]).concat(e.has(l.ROW)?[e.field(l.ROW)]:[]),r={
name:s.STACKED_SCALE,source:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(t)].concat(a),summarize:[{ops:["sum"],field:e.field(i)}]}]};return r}e.def=n}(y=t.stack||(t.stack={}));var O;!function(e){function n(e){var n={};return e.reduce(function(e,t,i){if(t.timeUnit){var a=m.rawDomain(t.timeUnit,i);a&&!n[t.timeUnit]&&(n[t.timeUnit]=!0,e.push({name:t.timeUnit,values:a,transform:[{type:"formula",field:"date",expr:m.parseExpression(t.timeUnit,"datum.data",!0)}]}))}return e},[])}e.defs=n}(O=t.dates||(t.dates={})),t.rankTransform=a,t.filterNonPositiveForLog=r},{"../bin":8,"../channel":9,"../data":29,"../fielddef":31,"../type":44,"../util":45,"./scale":25,"./time":27}],15:[function(e,n,t){function i(e,n){var t=e.has(m.ROW),i=e.has(m.COLUMN);return e.has(m.ROW)&&!e.isDimension(m.ROW)&&d.error("Row encoding should be ordinal."),e.has(m.COLUMN)&&!e.isDimension(m.COLUMN)&&d.error("Col encoding should be ordinal."),{marks:[].concat(u(e),[r(e,n)]),scales:g.compileScales(e.channels(),e),axes:[].concat(t&&e.axis(m.ROW)?[h.compileAxis(m.ROW,e)]:[],i&&e.axis(m.COLUMN)?[h.compileAxis(m.COLUMN,e)]:[])}}function a(e){var n=[];return e.has(m.X)&&e.axis(m.X)&&h.gridShow(e,m.X)&&n.push(h.compileInnerAxis(m.X,e)),e.has(m.Y)&&e.axis(m.Y)&&h.gridShow(e,m.Y)&&n.push(h.compileInnerAxis(m.Y,e)),n}function r(e,n){var t=e.spec().name,i={name:(t?t+"-":"")+"cell",type:"group",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[].concat(e.has(m.ROW)?[e.field(m.ROW)]:[],e.has(m.COLUMN)?[e.field(m.COLUMN)]:[])}]},properties:{update:o(e)},marks:n},r=a(e);return r.length>0&&(i.axes=r),i}function o(e){var n={x:e.has(m.COLUMN)?{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN),offset:e.scale(m.COLUMN).padding/2}:{value:e.config().facet.scale.padding/2},y:e.has(m.ROW)?{scale:e.scaleName(m.ROW),field:e.field(m.ROW),offset:e.scale(m.ROW).padding/2}:{value:e.config().facet.scale.padding/2},width:{field:{parent:"cellWidth"}},height:{field:{parent:"cellHeight"}}};return v.applyConfig(n,e.config().unit,v.FILL_STROKE_CONFIG.concat(["clip"])),v.applyConfig(n,e.config().facet.unit,v.FILL_STROKE_CONFIG.concat(["clip"])),n}function u(e){var n=[];return e.has(m.X)?e.axis(m.X)&&n.push(c(e)):e.has(m.ROW)&&n.push.apply(n,s(e)),e.has(m.Y)?e.axis(m.Y)&&n.push(l(e)):e.has(m.COLUMN)&&n.push.apply(n,f(e)),n}function c(e){var n=e.has(m.COLUMN),t=e.spec().name;return p.extend({name:(t?t+"-":"")+"x-axes",type:"group"},n?{from:{data:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(m.COLUMN)],summarize:{"*":"count"}}]}}:{},{properties:{update:{width:{field:{parent:"cellWidth"}},height:{field:{group:"height"}},x:n?{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN),offset:e.scale(m.COLUMN).padding/2}:{value:e.config().facet.scale.padding/2}}}},e.axis(m.X)?{axes:[h.compileAxis(m.X,e)]}:{})}function l(e){var n=e.has(m.ROW),t=e.spec().name;return p.extend({name:(t?t+"-":"")+"y-axes",type:"group"},n?{from:{data:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(m.ROW)],summarize:{"*":"count"}}]}}:{},{properties:{update:{width:{field:{group:"width"}},height:{field:{parent:"cellHeight"}},y:n?{scale:e.scaleName(m.ROW),field:e.field(m.ROW),offset:e.scale(m.ROW).padding/2}:{value:e.config().facet.scale.padding/2}}}},e.axis(m.Y)?{axes:[h.compileAxis(m.Y,e)]}:{})}function s(e){var n=e.spec().name,t=e.config().facet.grid,i={name:(n?n+"-":"")+"row-grid",type:"rule",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[e.field(m.ROW)]}]},properties:{update:{y:{scale:e.scaleName(m.ROW),field:e.field(m.ROW)},x:{value:0,offset:-t.offset},x2:{field:{group:"width"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}};return[i,{name:(n?n+"-":"")+"row-grid-end",type:"rule",properties:{update:{y:{field:{group:"height"}},x:{value:0,offset:-t.offset},x2:{field:{group:"width"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}}]}function f(e){var n=e.spec().name,t=e.config().facet.grid,i={name:(n?n+"-":"")+"column-grid",type:"rule",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[e.field(m.COLUMN)]}]},properties:{update:{x:{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN)},y:{value:0,offset:-t.offset},y2:{field:{group:"height"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}};return[i,{name:(n?n+"-":"")+"column-grid-end",type:"rule",properties:{update:{x:{field:{group:"width"}},y:{value:0,offset:-t.offset},y2:{field:{group:"height"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}}]}var d=e("../util"),p=e("../util"),m=e("../channel"),h=e("./axis"),g=e("./scale"),v=e("./util");t.facetMixins=i},{"../channel":9,"../util":45,"./axis":11,"./scale":25,"./util":28}],16:[function(e,n,t){function i(e){var n=[u.X,u.Y,u.ROW,u.COLUMN].reduce(function(n,t){if(e.has(t)&&e.isOrdinalScale(t)){var i=e.scale(t);i.domain instanceof Array||n.push({field:e.field(t),ops:["distinct"]})}return n},[]),t=r(e,u.X,e.config().unit.width),i=r(e,u.Y,e.config().unit.height),a=e.has(u.COLUMN)||e.has(u.ROW),l=[{type:"formula",field:"cellWidth",expr:t},{type:"formula",field:"cellHeight",expr:i},{type:"formula",field:"width",expr:a?o(e,u.COLUMN,"datum.cellWidth"):t},{type:"formula",field:"height",expr:a?o(e,u.ROW,"datum.cellHeight"):i}];return n.length>0?{name:c.LAYOUT,source:e.dataTable(),transform:[].concat([{type:"aggregate",summarize:n}],l)}:{name:c.LAYOUT,values:[{}],transform:l}}function a(e,n){var t=e.scale(n);if(t.domain instanceof Array)return t.domain.length;var i=e.fieldDef(n).timeUnit,a=i?s.rawDomain(i,n):null;return null!==a?a.length:e.field(n,{datum:!0,prefn:"distinct_"})}function r(e,n,t){if(e.has(n)){if(e.isOrdinalScale(n)){var i=e.scale(n);return"("+a(e,n)+" + "+i.padding+") * "+i.bandWidth}return t+""}return e.mark()===l.TEXT&&n===u.X?e.config().scale.textBandWidth+"":e.config().scale.bandWidth+""}function o(e,n,t){var i=e.scale(n);if(e.has(n)){var a=i.domain instanceof Array?i.domain.length:e.field(n,{datum:!0,prefn:"distinct_"});return"("+t+" + "+i.padding+") * "+a}return t+" + "+e.config().facet.scale.padding}var u=e("../channel"),c=e("../data"),l=e("../mark"),s=e("./time");t.compileLayoutData=i},{"../channel":9,"../data":29,"../mark":32,"./time":27}],17:[function(e,n,t){function i(e){var n=[];if(e.has(c.COLOR)&&e.legend(c.COLOR)){var t=e.fieldDef(c.COLOR),i=u(t)?m.COLOR_LEGEND:e.scaleName(c.COLOR);n.push(a(e,c.COLOR,e.config().mark.filled?{fill:i}:{stroke:i}))}return e.has(c.SIZE)&&e.legend(c.SIZE)&&n.push(a(e,c.SIZE,{size:e.scaleName(c.SIZE)})),e.has(c.SHAPE)&&e.legend(c.SHAPE)&&n.push(a(e,c.SHAPE,{shape:e.scaleName(c.SHAPE)})),n}function a(e,n,t){var i=e.fieldDef(n),a=e.legend(n);t.title=r(a,i),f.extend(t,o(a,e,n)),["orient","values"].forEach(function(e){var n=a[e];void 0!==n&&(t[e]=n)});var u="boolean"!=typeof a&&a.properties||{};return["title","symbols","legend","labels"].forEach(function(a){var r=h[a]?h[a](i,u[a],e,n):u[a];void 0!==r&&(t.properties=t.properties||{},t.properties[a]=r)}),t}function r(e,n){return"boolean"!=typeof e&&e.title?e.title:l.title(n)}function o(e,n,t){var i=n.fieldDef(t);return i.bin?{}:d.formatMixins(n,t,"boolean"!=typeof e?e.format:void 0)}function u(e){return e.type===p.ORDINAL||e.bin||e.timeUnit}var c=e("../channel"),l=e("../fielddef"),s=e("../mark"),f=e("../util"),d=e("./util"),p=e("../type"),m=e("./scale");t.compileLegends=i,t.compileLegend=a,t.title=r,t.formatMixins=o,t.useColorLegendScale=u;var h;!function(e){function n(e,n,t,i){var a={},r=t.mark();switch(r){case s.BAR:case s.TICK:case s.TEXT:a.shape={value:"square"};break;case s.CIRCLE:case s.SQUARE:a.shape={value:r};break;case s.POINT:case s.LINE:case s.AREA:}var o=t.config().mark.filled;d.applyMarkConfig(a,t,f.without(d.FILL_STROKE_CONFIG,[o?"fill":"stroke"])),o&&(a.strokeWidth={value:0});var l;return t.has(c.COLOR)&&i===c.COLOR?u(e)&&(l={scale:t.scaleName(c.COLOR),field:"data"}):t.fieldDef(c.COLOR).value&&(l={value:t.fieldDef(c.COLOR).value}),void 0!==l?o?a.fill=l:a.stroke=l:i!==c.COLOR&&(a[o?"fill":"stroke"]=a[o?"fill":"stroke"]||{value:t.config().mark.color}),a=f.extend(a,n||{}),f.keys(a).length>0?a:void 0}function t(e,n,t,i){if(i===c.COLOR){if(e.type===p.ORDINAL)return{text:{scale:m.COLOR_LEGEND,field:"data"}};if(e.bin)return{text:{scale:m.COLOR_LEGEND_LABEL,field:"data"}};if(e.timeUnit)return{text:{template:"{{ datum.data | time:'"+d.timeFormat(t,i)+"'}}"}}}}e.symbols=n,e.labels=t}(h||(h={}))},{"../channel":9,"../fielddef":31,"../mark":32,"../type":44,"../util":45,"./scale":25,"./util":28}],18:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"area"}function t(e){var n={},t=e.config().mark.orient;void 0!==t&&(n.orient={value:t});var i=e.stack();return i&&a.X===i.fieldChannel?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_start"})}:e.isMeasure(a.X)?n.x={scale:e.scaleName(a.X),field:e.field(a.X)}:e.isDimension(a.X)&&(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}),"horizontal"===t&&(i&&a.X===i.fieldChannel?n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_end"})}:n.x2={scale:e.scaleName(a.X),value:0}),i&&a.Y===i.fieldChannel?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_start"})}:e.isMeasure(a.Y)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y)}:e.isDimension(a.Y)&&(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}),"horizontal"!==t&&(i&&a.Y===i.fieldChannel?n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_end"})}:n.y2={scale:e.scaleName(a.Y),value:0}),r.applyColorAndOpacity(n,e),r.applyMarkConfig(n,e,["interpolate","tension"]),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.area||(t.area={}))},{"../channel":9,"./util":28}],19:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"rect"}function t(e){var n={},t=e.config().mark.orient,i=e.stack();return i&&a.X===i.fieldChannel?(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_start"})},n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_end"})}):e.isMeasure(a.X)?"horizontal"===t?(n.x={scale:e.scaleName(a.X),field:e.field(a.X)},n.x2={scale:e.scaleName(a.X),value:0}):(n.xc={scale:e.scaleName(a.X),field:e.field(a.X)},n.width={value:e.sizeValue(a.X)}):e.fieldDef(a.X).bin?e.has(a.SIZE)&&"horizontal"!==t?(n.xc={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})},n.width={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}):(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_start"}),offset:1},n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_end"})}):(e.has(a.X)?n.xc={scale:e.scaleName(a.X),field:e.field(a.X)}:n.x={value:0,offset:2},n.width=e.has(a.SIZE)&&"horizontal"!==t?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:e.sizeValue(a.X)}),i&&a.Y===i.fieldChannel?(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_start"})},n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_end"})}):e.isMeasure(a.Y)?"horizontal"!==t?(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y)},n.y2={scale:e.scaleName(a.Y),value:0}):(n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y)},n.height={value:e.sizeValue(a.Y)}):e.fieldDef(a.Y).bin?e.has(a.SIZE)&&"horizontal"===t?(n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})},n.height={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}):(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_start"})},n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_end"}),offset:1}):(e.has(a.Y)?n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y)}:n.y2={field:{group:"height"},offset:-1},n.height=e.has(a.SIZE)&&"horizontal"===t?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:e.sizeValue(a.Y)}),r.applyColorAndOpacity(n,e),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.bar||(t.bar={}))},{"../channel":9,"./util":28}],20:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"line"}function t(e){var n={};return e.has(a.X)?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:n.x={value:0},e.has(a.Y)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.y={field:{group:"height"}},r.applyColorAndOpacity(n,e),r.applyMarkConfig(n,e,["interpolate","tension"]),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.line||(t.line={}))},{"../channel":9,"./util":28}],21:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"symbol"}function t(e,n){var t={};return e.has(a.X)?t.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:t.x={value:10.5},e.has(a.Y)?t.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:t.y={value:10.5},e.has(a.SIZE)?t.size={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:t.size={value:e.sizeValue()},n?t.shape={value:n}:e.has(a.SHAPE)?t.shape={scale:e.scaleName(a.SHAPE),field:e.field(a.SHAPE)}:e.fieldDef(a.SHAPE).value?t.shape={value:e.fieldDef(a.SHAPE).value}:e.config().mark.shape&&(t.shape={value:e.config().mark.shape}),r.applyColorAndOpacity(t,e),t}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.point||(t.point={}));var o;!function(e){function n(){return"symbol"}function t(e){return i.properties(e,"circle")}function a(e){}e.markType=n,e.properties=t,e.labels=a}(o=t.circle||(t.circle={}));var u;!function(e){function n(){return"symbol"}function t(e){return i.properties(e,"square")}function a(e){}e.markType=n,e.properties=t,e.labels=a}(u=t.square||(t.square={}))},{"../channel":9,"./util":28}],22:[function(e,n,t){var i,a=e("../channel"),r=e("./util"),o=e("../util"),u=e("../type");!function(e){function n(){return"text"}function t(e){return{x:{value:0},y:{value:0},width:{field:{group:"width"}},height:{field:{group:"height"}},fill:{scale:e.scaleName(a.COLOR),field:e.field(a.COLOR,e.fieldDef(a.COLOR).type===u.ORDINAL?{prefn:"rank_"}:{})}}}function i(e){var n={};r.applyMarkConfig(n,e,["angle","align","baseline","dx","dy","font","fontWeight","fontStyle","radius","theta","text"]);var t=e.fieldDef(a.TEXT);if(e.has(a.X)?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:e.has(a.TEXT)&&e.fieldDef(a.TEXT).type===u.QUANTITATIVE?n.x={field:{group:"width"},offset:-5}:n.x={value:45},e.has(a.Y)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.y={value:10.5},e.has(a.SIZE)?n.fontSize={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:n.fontSize={value:e.sizeValue()},!e.config().mark.applyColorToBackground||e.has(a.X)||e.has(a.Y))r.applyColorAndOpacity(n,e);else{n.fill={value:"black"};var i=e.config().mark.opacity;i&&(n.opacity={value:i})}if(e.has(a.TEXT))if(o.contains([u.QUANTITATIVE,u.TEMPORAL],e.fieldDef(a.TEXT).type)){var c=e.config().mark.format;o.extend(n,r.formatMixins(e,a.TEXT,c))}else n.text={field:e.field(a.TEXT)};else t.value&&(n.text={value:t.value});return n}e.markType=n,e.background=t,e.properties=i}(i=t.text||(t.text={}))},{"../channel":9,"../type":44,"../util":45,"./util":28}],23:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"rect"}function t(e){var n={};return e.has(a.X)?n.xc={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:n.xc={value:10.5},e.has(a.Y)?n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.yc={value:10.5},"horizontal"===e.config().mark.orient?(n.width={value:e.config().mark.thickness},n.height=e.has(a.SIZE)?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:e.sizeValue(a.Y)}):(n.width=e.has(a.SIZE)?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:e.sizeValue(a.X)},n.height={value:e.config().mark.thickness}),r.applyColorAndOpacity(n,e),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.tick||(t.tick={}))},{"../channel":9,"./util":28}],24:[function(e,n,t){function i(e){return d.contains([s.LINE,s.AREA],e.mark())?a(e):r(e)}function a(e){var n=e.mark(),t=e.spec().name,i=e.has(l.ROW)||e.has(l.COLUMN),a={data:e.dataTable()},r=c(e),p=[d.extend(t?{name:t+"-marks"}:{},{type:T[n].markType(),from:d.extend(i||r.length>0?{}:a,{transform:[{type:"sort",by:u(e)}]}),properties:{update:T[n].properties(e)}})];if(r.length>0){var m={type:"facet",groupby:r},h=n===s.AREA&&e.stack()?[f.imputeTransform(e),f.stackTransform(e),m]:[].concat(m,e.has(l.ORDER)?[{type:"sort",by:o(e)}]:[]);return[{name:(t?t+"-":"")+n+"-facet",type:"group",from:d.extend(i?{}:a,{transform:h}),properties:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:p}]}return p}function r(e){var n=e.mark(),t=e.spec().name,i=e.has(l.ROW)||e.has(l.COLUMN),a={data:e.dataTable()},r=[];if(n===s.TEXT&&e.has(l.COLOR)&&e.config().mark.applyColorToBackground&&!e.has(l.X)&&!e.has(l.Y)&&r.push(d.extend(t?{name:t+"-background"}:{},{type:"rect"},i?{}:{from:a},{properties:{update:v.text.background(e)}})),r.push(d.extend(t?{name:t+"-marks"}:{},{type:T[n].markType()},!i||e.stack()||e.has(l.ORDER)?{from:d.extend(i?{}:a,e.stack()?{transform:[f.stackTransform(e)]}:e.has(l.ORDER)?{transform:[{type:"sort",by:o(e)}]}:{})}:{},{properties:{update:T[n].properties(e)}})),e.has(l.LABEL)&&T[n].labels){var u=T[n].labels(e);void 0!==u&&r.push(d.extend(t?{name:t+"-label"}:{},{type:"text"},i?{}:{from:a},{properties:{update:u}}))}return r}function o(e){if(e.has(l.ORDER)){var n=e.encoding().order;return n instanceof Array?n.map(O.sortField):O.sortField(n)}return null}function u(e){if(e.mark()===s.LINE&&e.has(l.PATH)){var n=e.encoding().path;return n instanceof Array?n.map(O.sortField):O.sortField(n)}return"-"+e.field("horizontal"===e.config().mark.orient?l.Y:l.X)}function c(e){return[l.COLOR,l.DETAIL,l.SHAPE].reduce(function(n,t){return e.has(t)&&!e.fieldDef(t).aggregate&&n.push(e.field(t)),n},[])}var l=e("../channel"),s=e("../mark"),f=e("./stack"),d=e("../util"),p=e("./mark-area"),m=e("./mark-bar"),h=e("./mark-line"),g=e("./mark-point"),v=e("./mark-text"),y=e("./mark-tick"),O=e("./util"),T={area:p.area,bar:m.bar,line:h.line,point:g.point,text:v.text,tick:y.tick,circle:g.circle,square:g.square};t.compileMark=i},{"../channel":9,"../mark":32,"../util":45,"./mark-area":18,"./mark-bar":19,"./mark-line":20,"./mark-point":21,"./mark-text":22,"./mark-tick":23,"./stack":26,"./util":28}],25:[function(e,n,t){function i(e,n){return e.filter(x.hasScale).reduce(function(e,t){var i=n.fieldDef(t);return t===x.COLOR&&n.legend(x.COLOR)&&(i.type===C.ORDINAL||i.bin||i.timeUnit)&&(e.push(r(n,i)),i.bin&&e.push(o(n,i))),e.push(a(n,i,t)),e},[])}function a(e,n,i){var a=e.scale(i),r=e.sort(i),o={name:e.scaleName(i),type:u(a,n,i,e.mark())};return o.domain=c(a,e,i,o.type),O.extend(o,f(a,e,i,o.type)),r&&"descending"===("string"==typeof r?r:r.order)&&(o.reverse=!0),["round","clamp","nice","exponent","zero","padding","points"].forEach(function(e){var r=t[e](a[e],o.type,i,n);void 0!==r&&(o[e]=r)}),o}function r(e,n){return{name:t.COLOR_LEGEND,type:"ordinal",domain:{data:e.dataTable(),field:e.field(x.COLOR,n.bin||n.timeUnit?{}:{prefn:"rank_"}),sort:!0},range:{data:e.dataTable(),field:e.field(x.COLOR),sort:!0}}}function o(e,n){return{name:t.COLOR_LEGEND_LABEL,type:"ordinal",domain:{data:e.dataTable(),field:e.field(x.COLOR,{prefn:"rank_"}),sort:!0},range:{data:e.dataTable(),field:L.field(n,{binSuffix:"_range"}),sort:{field:e.field(x.COLOR,{binSuffix:"_start"}),op:"min"}}}}function u(e,n,t,i){if(!x.hasScale(t))return null;if(O.contains([x.ROW,x.COLUMN,x.SHAPE],t))return"ordinal";if(void 0!==e.type)return e.type;switch(n.type){case C.NOMINAL:return"ordinal";case C.ORDINAL:return t===x.COLOR?"linear":"ordinal";case C.TEMPORAL:if(t===x.COLOR)return"time";if(n.timeUnit)switch(n.timeUnit){case"hours":case"day":case"month":return"ordinal";default:return"time"}return"time";case C.QUANTITATIVE:return n.bin?O.contains([x.X,x.Y,x.COLOR],t)?"linear":"ordinal":"linear"}return null}function c(e,n,t,i){var a=n.fieldDef(t);if(e.domain)return e.domain;if(a.type===C.TEMPORAL)return b.rawDomain(a.timeUnit,t)?{data:a.timeUnit,field:"date"}:{data:n.dataTable(),field:n.field(t),sort:{field:n.field(t),op:"min"}};var r=n.stack();if(r&&t===r.fieldChannel)return"normalize"===r.offset?[0,1]:{data:E.STACKED_SCALE,field:n.field(t,{prefn:"sum_"})};var o=s(e,n,t,i),u=l(n,t,i);return o?{data:E.SOURCE,field:n.field(t,{noAggregate:!0})}:a.bin?"ordinal"===i?{data:n.dataTable(),field:n.field(t,{binSuffix:"_range"}),sort:{field:n.field(t,{binSuffix:"_start"}),op:"min"}}:t===x.COLOR?{data:n.dataTable(),field:n.field(t,{binSuffix:"_start"})}:{data:n.dataTable(),field:[n.field(t,{binSuffix:"_start"}),n.field(t,{binSuffix:"_end"})]}:u?{data:u.op?E.SOURCE:n.dataTable(),field:a.type===C.ORDINAL&&t===x.COLOR?n.field(t,{prefn:"rank_"}):n.field(t),sort:u}:{data:n.dataTable(),field:a.type===C.ORDINAL&&t===x.COLOR?n.field(t,{prefn:"rank_"}):n.field(t)}}function l(e,n,t){if("ordinal"===t){var i=e.sort(n);return O.contains(["ascending","descending",void 0],i)?!0:"string"!=typeof i?{op:i.op,field:i.field}:void 0}}function s(e,n,t,i){var a=n.fieldDef(t);return e.useRawDomain&&a.aggregate&&T.SHARED_DOMAIN_OPS.indexOf(a.aggregate)>=0&&(a.type===C.QUANTITATIVE&&!a.bin||a.type===C.TEMPORAL&&O.contains(["time","utc"],i))}function f(e,n,t,i){var a=n.fieldDef(t);if("ordinal"===i&&e.bandWidth&&O.contains([x.X,x.Y],t))return{bandWidth:e.bandWidth};if(e.range&&!O.contains([x.X,x.Y,x.ROW,x.COLUMN],t))return{range:e.range};switch(t){case x.X:return{rangeMin:0,rangeMax:n.config().unit.width};case x.Y:return{rangeMin:n.config().unit.height,rangeMax:0};case x.SIZE:if(n.is(A.BAR)){var r="horizontal"===n.config().mark.orient?x.Y:x.X;return{range:[2,n.scale(r).bandWidth]}}if(n.is(A.TEXT))return{range:[8,40]};var o=n.isMeasure(x.X),u=n.isMeasure(x.Y),c=o!==u?n.scale(o?x.Y:x.X).bandWidth:Math.min(n.scale(x.X).bandWidth||n.config().scale.bandWidth,n.scale(x.Y).bandWidth||n.config().scale.bandWidth);return{range:[9,(c-2)*(c-2)]};case x.SHAPE:return{range:"shapes"};case x.COLOR:return a.type===C.NOMINAL?{range:"category10"}:{range:["#AFC6A3","#09622A"]};case x.ROW:return{range:"height"};case x.COLUMN:return{range:"width"}}return{}}function d(e,n){return O.contains(["linear","pow","sqrt","log","time","utc"],n)?e:void 0}function p(e,n){return"pow"===n?e:void 0}function m(e,n,t,i){return O.contains(["linear","pow","sqrt","log","time","utc","quantize"],n)?void 0!==e?e:O.contains(["time","utc"],n)?b.smallestUnit(i.timeUnit):O.contains([x.X,x.Y],t):void 0}function h(e,n,t){return"ordinal"===n&&O.contains([x.X,x.Y],t)?e:void 0}function g(e,n,t){return"ordinal"===n&&O.contains([x.X,x.Y],t)?!0:void 0}function v(e,n,t){return O.contains([x.X,x.Y,x.ROW,x.COLUMN,x.SIZE],t)&&void 0!==e?e:void 0}function y(e,n,t,i){return O.contains(["time","utc","ordinal"],n)?void 0:void 0!==e?e:!i.bin&&O.contains([x.X,x.Y],t)}var O=e("../util"),T=e("../aggregate"),x=e("../channel"),E=e("../data"),C=e("../type"),A=e("../mark"),b=e("./time"),L=e("../fielddef");t.COLOR_LEGEND="color_legend",t.COLOR_LEGEND_LABEL="color_legend_label",t.compileScales=i,t.type=u,t.domain=c,t.domainSort=l,t.rangeMixins=f,t.clamp=d,t.exponent=p,t.nice=m,t.padding=h,t.points=g,t.round=v,t.zero=y},{"../aggregate":7,"../channel":9,"../data":29,"../fielddef":31,"../mark":32,"../type":44,"../util":45,"./time":27}],26:[function(e,n,t){function i(e,n,t,i){var r=a(e,n,t);if(r.length>0&&f.contains([c.BAR,c.AREA],e)&&"none"!==i.mark.stacked&&s.isAggregate(n)){var o=s.has(n,u.X)&&l.isMeasure(n.x),d=s.has(n,u.Y)&&l.isMeasure(n.y);if(o&&!d)return{groupbyChannel:u.Y,fieldChannel:u.X,stackFields:r,offset:i.mark.stacked};if(d&&!o)return{groupbyChannel:u.X,fieldChannel:u.Y,stackFields:r,offset:i.mark.stacked}}return null}function a(e,n,t){return[u.COLOR,u.DETAIL].reduce(function(i,a){var r=n[a];if(s.has(n,a))if(f.isArray(r))r.forEach(function(e){i.push(l.field(e))});else{var o=r;i.push(l.field(o,{binSuffix:"ordinal"===p.type(t[a],o,a,e)?"_range":"_start"}))}return i},[])}function r(e){var n=e.stack();return{type:"impute",field:e.field(n.fieldChannel),groupby:n.stackFields,orderby:[e.field(n.groupbyChannel)],method:"value",value:0}}function o(e){var n=e.stack(),t=e.encoding(),i=e.has(u.ORDER)?(f.isArray(t[u.ORDER])?t[u.ORDER]:[t[u.ORDER]]).map(d.sortField):n.stackFields.map(function(e){return"-"+e}),a=e.field(n.fieldChannel),r={type:"stack",groupby:[e.field(n.groupbyChannel)],field:e.field(n.fieldChannel),sortby:i,output:{start:a+"_start",end:a+"_end"}};return n.offset&&(r.offset=n.offset),r}var u=e("../channel"),c=e("../mark"),l=e("../fielddef"),s=e("../encoding"),f=e("../util"),d=e("./util"),p=e("./scale");t.compileStackProperties=i,t.imputeTransform=r,t.stackTransform=o},{"../channel":9,"../encoding":30,"../fielddef":31,"../mark":32,"../util":45,"./scale":25,"./util":28}],27:[function(e,n,t){function i(e,n){if(void 0===n&&(n=!1),e){var t=[];e.indexOf("year")>-1&&t.push(n?"%y":"%Y"),e.indexOf("month")>-1&&t.push(n?"%b":"%B"),e.indexOf("day")>-1?t.push(n?"%a":"%A"):e.indexOf("date")>-1&&t.push("%d");var i=[];e.indexOf("hour")>-1&&i.push("%H"),e.indexOf("minute")>-1&&i.push("%M"),e.indexOf("second")>-1&&i.push("%S"),e.indexOf("milliseconds")>-1&&i.push("%L");var a=[];return t.length>0&&a.push(t.join("-")),i.length>0&&a.push(i.join(":")),a.length>0?a.join(" "):void 0}}function a(e){return e?e.indexOf("second")>-1?"second":e.indexOf("minute")>-1?"minute":e.indexOf("hour")>-1?"hour":e.indexOf("day")>-1||e.indexOf("date")>-1?"day":e.indexOf("month")>-1?"month":e.indexOf("year")>-1?"year":void 0:void 0}function r(e,n,t){function i(e,i){return void 0===i&&(i=!0),t?n+(i?", ":""):e+"("+n+")"+(i?", ":"")}void 0===t&&(t=!1);var a="datetime(";return a+=e.indexOf("year")>-1?i("year"):"2006, ",a+=e.indexOf("month")>-1?i("month"):"0, ",a+=e.indexOf("day")>-1?i("day",!1)+"+1, ":e.indexOf("date")>-1?i("date"):"1, ",a+=e.indexOf("hours")>-1?i("hours"):"0, ",a+=e.indexOf("minutes")>-1?i("minutes"):"0, ",a+=e.indexOf("seconds")>-1?i("seconds"):"0, ",a+=e.indexOf("milliseconds")>-1?i("milliseconds",!1):"0",a+")"}function o(e,n){if(u.contains([c.ROW,c.COLUMN,c.SHAPE,c.COLOR],n))return null;switch(e){case"seconds":return u.range(0,60);case"minutes":return u.range(0,60);case"hours":return u.range(0,24);case"day":return u.range(0,7);case"date":return u.range(1,32);case"month":return u.range(0,12)}return null}var u=e("../util"),c=e("../channel");t.format=i,t.smallestUnit=a,t.parseExpression=r,t.rawDomain=o},{"../channel":9,"../util":45}],28:[function(e,n,t){function i(e,n){var i=n.config().mark.filled,a=n.fieldDef(s.COLOR);r(e,n,t.FILL_STROKE_CONFIG);var o;n.has(s.COLOR)?o={scale:n.scaleName(s.COLOR),field:n.field(s.COLOR,a.type===d.ORDINAL?{prefn:"rank_"}:{})}:a&&a.value&&(o={value:a.value}),void 0!==o?i?e.fill=o:e.stroke=o:e[i?"fill":"stroke"]=e[i?"fill":"stroke"]||{value:n.config().mark.color}}function a(e,n,t){t.forEach(function(t){var i=n[t];void 0!==i&&(e[t]={value:i})})}function r(e,n,t){a(e,n.config().mark,t)}function o(e,n,t){var i=e.fieldDef(n);if(!m.contains([d.QUANTITATIVE,d.TEMPORAL],i.type))return{};var a={};if(i.type===d.TEMPORAL&&(a.formatType="time"),void 0!==t)a.format=t;else switch(i.type){case d.QUANTITATIVE:a.format=e.config().numberFormat;break;case d.TEMPORAL:a.format=l(e,n)||e.config().timeFormat}if(n===s.TEXT){var r=(a.formatType||"number")+(a.format?":'"+a.format+"'":"");return{text:{template:"{{"+e.field(n,{datum:!0})+" | "+r+"}}"}}}return a}function u(e,n,t){switch(n){case s.ROW:case s.COLUMN:case s.X:case s.Y:return e.axis(n).shortTimeLabels;case s.COLOR:case s.SHAPE:case s.SIZE:return e.legend(n).shortTimeLabels;case s.TEXT:return e.config().mark.shortTimeLabels;case s.LABEL:}return!1}function c(e){return("descending"===e.sort?"-":"")+f.field(e)}function l(e,n){var t=e.fieldDef(n);return p.format(t.timeUnit,u(e,n,t))}var s=e("../channel"),f=e("../fielddef"),d=e("../type"),p=e("./time"),m=e("../util");t.FILL_STROKE_CONFIG=["fill","fillOpacity","stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","opacity"],t.applyColorAndOpacity=i,t.applyConfig=a,t.applyMarkConfig=r,t.formatMixins=o,t.sortField=c,t.timeFormat=l},{"../channel":9,"../fielddef":31,"../type":44,"../util":45,"./time":27}],29:[function(e,n,t){var i=e("./type");t.SUMMARY="summary",t.SOURCE="source",t.STACKED_SCALE="stacked_scale",t.LAYOUT="layout",t.types={"boolean":i.NOMINAL,number:i.QUANTITATIVE,integer:i.QUANTITATIVE,date:i.TEMPORAL,string:i.NOMINAL}},{"./type":44}],30:[function(e,n,t){function i(e){var n=0;return e.color&&n++,e.size&&n++,e.shape&&n++,n}function a(e){return f.CHANNELS.filter(function(n){return r(e,n)})}function r(e,n){var t=e&&e[n];return t&&(void 0!==t.field||d.isArray(t)&&t.length>0)}function o(e){return d.any(f.CHANNELS,function(n){return r(e,n)&&e[n].aggregate?!0:!1})}function u(e){var n=[];return f.CHANNELS.forEach(function(t){r(e,t)&&(d.isArray(e[t])?e[t].forEach(function(e){n.push(e)}):n.push(e[t]))}),n}function c(e,n,t){var i=0;f.CHANNELS.forEach(function(a){r(e,a)&&(d.isArray(e[a])?e[a].forEach(function(e){n.call(t,e,a,i++)}):n.call(t,e[a],a,i++))})}function l(e,n,t){var i=[];return f.CHANNELS.forEach(function(a){r(e,a)&&(d.isArray(e[a])?e[a].forEach(function(r){i.push(n.call(t,r,a,e))}):i.push(n.call(t,e[a],a,e)))}),i}function s(e,n,t,i){var a=t;return f.CHANNELS.forEach(function(t){r(e,t)&&(d.isArray(e[t])?e[t].forEach(function(r){a=n.call(i,a,r,t,e)}):a=n.call(i,a,e[t],t,e))}),a}var f=e("./channel"),d=e("./util");t.countRetinal=i,t.channels=a,t.has=r,t.isAggregate=o,t.fieldDefs=u,t.forEach=c,t.map=l,t.reduce=s},{"./channel":9,"./util":45}],31:[function(e,n,t){function i(e,n){void 0===n&&(n={});var t=(n.datum?"datum.":"")+(n.prefn||""),i=n.suffix||"",a=e.field;return c(e)?t+"count"+i:n.fn?t+n.fn+"_"+a+i:!n.nofn&&e.bin?t+"bin_"+a+(n.binSuffix||i||"_start"):n.nofn||n.noAggregate||!e.aggregate?!n.nofn&&e.timeUnit?t+e.timeUnit+"_"+a+i:t+a:t+e.aggregate+"_"+a+i}function a(e){return f.contains([d.NOMINAL,d.ORDINAL],e.type)||!!e.bin||e.type===d.TEMPORAL&&!!e.timeUnit}function r(e){return e&&e.field&&a(e)}function o(e){return e&&e.field&&!a(e)}function u(){return{field:"*",aggregate:"count",type:d.QUANTITATIVE,displayName:t.COUNT_DISPLAYNAME}}function c(e){return"count"===e.aggregate}function l(e,n,t){void 0===t&&(t={});var i=n[e.field],a=e.type;if(e.bin){var r=e.bin,o="boolean"==typeof r?void 0:r.maxbins;void 0===o&&(o=10);var u=f.getbins(i,o);return(u.stop-u.start)/u.step}if(e.type===d.TEMPORAL){var c=e.timeUnit;switch(c){case"seconds":return 60;case"minutes":return 60;case"hours":return 24;case"day":return 7;case"date":return 31;case"month":return 12;case"year":var l=n["year_"+e.field];return l?l.distinct-(i.missing>0&&t[a]?1:0):null}}return e.aggregate?1:i.distinct-(i.missing>0&&t[a]?1:0)}function s(e){if(c(e))return t.COUNT_DISPLAYNAME;var n=e.aggregate||e.timeUnit||e.bin&&"bin";return n?n.toUpperCase()+"("+e.field+")":e.field}var f=e("./util"),d=e("./type");t.field=i,t.isDimension=r,t.isMeasure=o,t.COUNT_DISPLAYNAME="Number of Records",t.count=u,t.isCount=c,t.cardinality=l,t.title=s},{"./type":44,"./util":45}],32:[function(e,n,t){!function(e){e[e.AREA="area"]="AREA",e[e.BAR="bar"]="BAR",e[e.LINE="line"]="LINE",e[e.POINT="point"]="POINT",e[e.TEXT="text"]="TEXT",e[e.TICK="tick"]="TICK",e[e.CIRCLE="circle"]="CIRCLE",e[e.SQUARE="square"]="SQUARE"}(t.Mark||(t.Mark={}));var i=t.Mark;t.AREA=i.AREA,t.BAR=i.BAR,t.LINE=i.LINE,t.POINT=i.POINT,t.TEXT=i.TEXT,t.TICK=i.TICK,t.CIRCLE=i.CIRCLE,t.SQUARE=i.SQUARE},{}],33:[function(e,n,t){t.defaultAxisConfig={labels:!0,labelMaxLength:25,characterWidth:6},t.defaultFacetAxisConfig={axisWidth:0,labels:!0,grid:!1,tickSize:0}},{}],34:[function(e,n,t){var i=e("./scale.schema"),a=e("./axis.schema"),r=e("./config.unit.schema"),o={color:"#000000",opacity:.4,offset:0};t.defaultFacetConfig={scale:i.defaultFacetScaleConfig,axis:a.defaultFacetAxisConfig,grid:o,unit:r.defaultFacetUnitConfig}},{"./axis.schema":33,"./config.unit.schema":37,"./scale.schema":39}],35:[function(e,n,t){t.defaultMarkConfig={color:"#4682b4",strokeWidth:2,size:30,thickness:1,fontSize:10,baseline:"middle",text:"Abc",shortTimeLabels:!1,applyColorToBackground:!1}},{}],36:[function(e,n,t){var i=e("./config.unit.schema"),a=e("./config.facet.schema"),r=e("./config.marks.schema"),o=e("./scale.schema"),u=e("./axis.schema"),c=e("./legend.schema");
t.defaultConfig={numberFormat:"s",timeFormat:"%Y-%m-%d",unit:i.defaultUnitConfig,mark:r.defaultMarkConfig,scale:o.defaultScaleConfig,axis:u.defaultAxisConfig,legend:c.defaultLegendConfig,facet:a.defaultFacetConfig}},{"./axis.schema":33,"./config.facet.schema":34,"./config.marks.schema":35,"./config.unit.schema":37,"./legend.schema":38,"./scale.schema":39}],37:[function(e,n,t){t.defaultUnitConfig={width:200,height:200},t.defaultFacetUnitConfig={stroke:"#ccc",strokeWidth:1}},{}],38:[function(e,n,t){t.defaultLegendConfig={}},{}],39:[function(e,n,t){t.defaultScaleConfig={round:!0,textBandWidth:90,bandWidth:21,padding:1,useRawDomain:!1},t.defaultFacetScaleConfig={round:!0,padding:16}},{}],40:[function(e,n,t){},{}],41:[function(e,n,t){function i(e){return"mark"+t.ASSIGN+e.mark+t.DELIM+r(e.encoding)}function a(e,n,i){var a=e.split(t.DELIM),r=a.shift().split(t.ASSIGN)[1].trim(),u=o(a.join(t.DELIM)),c={mark:m.Mark[r],encoding:u};return void 0!==n&&(c.data=n),void 0!==i&&(c.config=i),c}function r(e){return p.map(e,function(e,n){return n+t.ASSIGN+u(e)}).join(t.DELIM)}function o(e){return e.split(t.DELIM).reduce(function(e,n){var i=n.split(t.ASSIGN),a=i[0].trim(),r=i[1];return e[a]=l(r),e},{})}function u(e){return(e.aggregate?e.aggregate+t.FUNC:"")+(e.timeUnit?e.timeUnit+t.FUNC:"")+(e.bin?"bin"+t.FUNC:"")+(e.field||"")+t.TYPE+d.SHORT_TYPE[e.type]}function c(e,n){return void 0===n&&(n=t.DELIM),e.map(u).join(n)}function l(e){for(var n=e.split(t.TYPE),i={field:n[0].trim(),type:d.TYPE_FROM_SHORT_TYPE[n[1].trim()]},a=0;a<s.AGGREGATE_OPS.length;a++){var r=s.AGGREGATE_OPS[a];if(0===i.field.indexOf(r+"_")){i.field=i.field.substr(r.length+1),"count"===r&&0===i.field.length&&(i.field="*"),i.aggregate=r;break}}for(var a=0;a<f.TIMEUNITS.length;a++){var o=f.TIMEUNITS[a];if(i.field&&0===i.field.indexOf(o+"_")){i.field=i.field.substr(i.field.length+1),i.timeUnit=o;break}}return i.field&&0===i.field.indexOf("bin_")&&(i.field=i.field.substr(4),i.bin=!0),i}var s=e("./aggregate"),f=e("./timeunit"),d=e("./type"),p=e("./encoding"),m=e("./mark");t.DELIM="|",t.ASSIGN="=",t.TYPE=",",t.FUNC="_",t.shorten=i,t.parse=a,t.shortenEncoding=r,t.parseEncoding=o,t.shortenFieldDef=u,t.shortenFieldDefs=c,t.parseFieldDef=l},{"./aggregate":7,"./encoding":30,"./mark":32,"./timeunit":43,"./type":44}],42:[function(e,n,t){function i(e){return s.isAggregate(e.encoding)}function a(e){return s.fieldDefs(e.encoding)}function r(e){return new c.Model(e).toSpec(!0)}function o(e){return(s.has(e.encoding,l.COLOR)||s.has(e.encoding,l.SHAPE))&&(e.mark===f.BAR||e.mark===f.AREA)&&(!e.config||!e.config.mark.stacked!=!1)&&s.isAggregate(e.encoding)}function u(e){var n=e.encoding,t=d.duplicate(e.encoding);return t.x=n.y,t.y=n.x,t.row=n.column,t.column=n.row,e.encoding=t,e}var c=e("./compile/Model"),l=e("./channel"),s=e("./encoding"),f=e("./mark"),d=e("./util");t.alwaysNoOcclusion=i,t.fieldDefs=a,t.getCleanSpec=r,t.isStack=o,t.transpose=u},{"./channel":9,"./compile/Model":10,"./encoding":30,"./mark":32,"./util":45}],43:[function(e,n,t){t.TIMEUNITS=["year","month","day","date","hours","minutes","seconds","milliseconds","yearmonth","yearmonthday","yearmonthdate","yearday","yeardate","yearmonthdayhours","yearmonthdayhoursminutes","hoursminutes","hoursminutesseconds","minutesseconds","secondsmilliseconds"]},{}],44:[function(e,n,t){function i(e){var n=e;return t.TYPE_FROM_SHORT_TYPE[n.toUpperCase()]||n.toLowerCase()}!function(e){e[e.QUANTITATIVE="quantitative"]="QUANTITATIVE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TEMPORAL="temporal"]="TEMPORAL",e[e.NOMINAL="nominal"]="NOMINAL"}(t.Type||(t.Type={}));var a=t.Type;t.QUANTITATIVE=a.QUANTITATIVE,t.ORDINAL=a.ORDINAL,t.TEMPORAL=a.TEMPORAL,t.NOMINAL=a.NOMINAL,t.SHORT_TYPE={quantitative:"Q",temporal:"T",nominal:"N",ordinal:"O"},t.TYPE_FROM_SHORT_TYPE={Q:t.QUANTITATIVE,T:t.TEMPORAL,O:t.ORDINAL,N:t.NOMINAL},t.getFullName=i},{}],45:[function(e,n,t){function i(e,n){return e.indexOf(n)>-1}function a(e,n){return e.filter(function(e){return!i(n,e)})}function r(e,n,t){if(e.forEach)e.forEach.call(t,n);else for(var i in e)e.hasOwnProperty(i)&&n.call(t,e[i],i,e)}function o(e,n,t,i){if(e.reduce)return e.reduce.call(i,n,t);for(var a in e)e.hasOwnProperty(a)&&(t=n.call(i,t,e[a],a,e));return t}function u(e,n,t){if(e.map)return e.map.call(t,n);var i=[];for(var a in e)e.hasOwnProperty(a)&&i.push(n.call(t,e[a],a,e));return i}function c(e,n){for(var t=0,i=0;i<e.length;i++)if(n(e[i],i,t++))return!0;return!1}function l(e,n){for(var t=0,i=0;i<e.length;i++)if(!n(e[i],i,t++))return!1;return!0}function s(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var i=0;i<n.length;i++)e=f(e,n[i]);return e}function f(e,n){if("object"!=typeof n||null===n)return e;for(var t in n)n.hasOwnProperty(t)&&void 0!==n[t]&&("object"!=typeof n[t]||null===n[t]?e[t]=n[t]:"object"!=typeof e[t]||null===e[t]?e[t]=s(n[t].constructor===Array?[]:{},n[t]):s(e[t],n[t]));return e}function d(e,n){return g({min:e.min,max:e.max,maxbins:n})}function p(e){console.error("[VL Error]",e)}var m=e("datalib/src/util");t.keys=m.keys,t.extend=m.extend,t.duplicate=m.duplicate,t.isArray=m.isArray,t.vals=m.vals,t.truncate=m.truncate,t.toMap=m.toMap,t.isObject=m.isObject;var h=e("datalib/src/generate");t.range=h.range,t.contains=i,t.without=a,t.forEach=r,t.reduce=o,t.map=u,t.any=c,t.all=l,t.mergeDeep=s;var g=e("datalib/src/bins/bins");t.getbins=d,t.error=p},{"datalib/src/bins/bins":2,"datalib/src/generate":3,"datalib/src/util":5}],46:[function(e,n,t){function i(e,n,i){void 0===n&&(n=t.DEFAULT_REQUIRED_CHANNEL_MAP),void 0===i&&(i=t.DEFAULT_SUPPORTED_CHANNEL_TYPE);var a=e.mark,o=e.encoding,u=n[a],c=i[a];for(var l in u)if(!(u[l]in o))return'Missing encoding channel "'+u[l]+'" for mark "'+a+'"';for(var s in o)if(!c[s])return'Encoding channel "'+s+'" is not supported by mark type "'+a+'"';return a!==r.BAR||o.x||o.y?null:"Missing both x and y for bar"}var a=e("./util"),r=e("./mark");t.DEFAULT_REQUIRED_CHANNEL_MAP={text:["text"],line:["x","y"],area:["x","y"]},t.DEFAULT_SUPPORTED_CHANNEL_TYPE={bar:a.toMap(["row","column","x","y","size","color","detail"]),line:a.toMap(["row","column","x","y","color","detail"]),area:a.toMap(["row","column","x","y","color","detail"]),tick:a.toMap(["row","column","x","y","color","detail"]),circle:a.toMap(["row","column","x","y","color","size","detail"]),square:a.toMap(["row","column","x","y","color","size","detail"]),point:a.toMap(["row","column","x","y","color","size","detail","shape"]),text:a.toMap(["row","column","size","color","text"])},t.getEncodingMappingError=i},{"./mark":32,"./util":45}],47:[function(e,n,t){var i=e("./bin"),a=e("./channel"),r=e("./data"),o=e("./encoding"),u=e("./fielddef"),c=e("./compile/compile"),l=e("./schema/schema"),s=e("./shorthand"),f=e("./spec"),d=e("./timeunit"),p=e("./type"),m=e("./validate"),h=e("./util");t.bin=i,t.channel=a,t.compile=c.compile,t.data=r,t.encoding=o,t.fieldDef=u,t.schema=l,t.shorthand=s,t.spec=f,t.timeUnit=d,t.type=p,t.util=h,t.validate=m,t.version="0.9.3"},{"./bin":8,"./channel":9,"./compile/compile":12,"./data":29,"./encoding":30,"./fielddef":31,"./schema/schema":40,"./shorthand":41,"./spec":42,"./timeunit":43,"./type":44,"./util":45,"./validate":46}]},{},[47])(47)});
//# sourceMappingURL=vega-lite.min.js.map
